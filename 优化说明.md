# 简历信息提取工具 - 优化说明

## 优化内容

### 1. 文件名解析功能 ✅
- **新增功能**：从文件名中提取信息作为补充
- **支持格式**：`【岗位_地区 薪资】姓名 年限.pdf`
- **提取字段**：姓名、岗位、地区、工资
- **优势**：当PDF内容提取失败或不完整时，可以从文件名获取信息

### 2. 电话号码提取优化 ✅
- **支持格式**：
  - 标准格式：`13812345678`
  - 带括号：`(+86) 159-2842-3292`
  - 带横线：`138-1234-5678`
  - 带空格：`138 1234 5678`
- **提取策略**：先提取所有可能的数字段，然后验证是否为11位手机号
- **解决问题**：之前无法识别带格式的电话号码

### 3. 邮箱提取优化 ✅
- **改进**：返回最长的邮箱地址，避免截断
- **示例**：从 `5@163.com gsm2832954437@163.com` 中正确提取 `gsm2832954437@163.com`
- **解决问题**：之前可能提取到被截断的邮箱

### 4. 姓名提取优化 ✅
- **优化策略**：
  - 优先检查前3行的独立中文词
  - 缩小搜索范围（从200字符减少到100字符）
  - 增加常见职位词到过滤列表（如"前端工程师"、"后端开发"等）
- **解决问题**：减少误识别职位名称为姓名的情况

### 5. 地区提取优化 ✅
- **改进**：只返回识别的城市名，避免返回过多无关内容
- **新增功能**：`_extract_city_from_text()` 方法从文本中提取城市名
- **示例**：
  - 输入：`四川 成都 籍贯：四川 德阳 中江县 m`
  - 输出：`成都`
- **解决问题**：之前会返回整行文本，包含很多无关信息

### 6. 工资提取优化 ✅
- **改进**：只提取薪资数字部分，避免包含其他无关信息
- **支持格式**：
  - `8-12K`
  - `8k~12k`
  - `8000-12000`
- **示例**：
  - 输入：`9-14K | 期望城市：成都 c 0`
  - 输出：`9-14K`
- **解决问题**：之前会返回整行文本，包含城市等无关信息

### 7. 性别提取优化 ✅
- **新增功能**：从称呼推断性别（"先生"、"女士"、"Mr"、"Ms"等）
- **搜索范围**：前200字符
- **解决问题**：提高性别识别率

### 8. 年龄提取优化 ✅
- **支持格式**：
  - `年龄：26`
  - `26岁`
- **验证**：年龄范围18-70岁
- **解决问题**：支持更多年龄表达格式

## 提取优先级

对于每个字段，系统采用以下优先级：

1. **PDF内容提取**（优先）
2. **文件名解析**（补充）
3. **空值**（提取失败）

这样可以确保：
- 优先使用最准确的PDF内容
- 当PDF提取失败时，文件名可以作为补充
- 宁缺毋滥，提取不到就留空

## 测试结果

### 文件名解析测试
```
文件名: 【前端工程师_成都 9-14K】刘存麟 6年.pdf
  姓名: 刘存麟 ✓
  岗位: 前端工程师 ✓
  地区: 成都 ✓
  工资: 9-14K ✓
```

### 电话提取测试
```
(+86) 159-2842-3292 → 15928423292 ✓
138 1234 5678 → 13812345678 ✓
```

### 邮箱提取测试
```
5@163.com gsm2832954437@163.com → gsm2832954437@163.com ✓
```

### 地区提取测试
```
四川 成都 籍贯：四川 德阳 中江县 m → 成都 ✓
期望城市：成都 c 0 → 成都 ✓
```

### 工资提取测试
```
9-14K | 期望城市：成都 c 0 → 9-14K ✓
12-915k | 到岗时间：周内到岗 → 12-915K ✓
9k~12k 5 c → 9K~12K ✓
```

## 预期改进效果

根据优化内容，预期可以解决以下问题：

1. ✅ **姓名错误**：通过优化位置启发式策略和增加过滤词，减少误识别
2. ✅ **性别识别率低**：通过称呼推断，提高识别率
3. ✅ **电话识别失败**：支持更多格式，解决带括号、横线等格式的识别
4. ✅ **地区提取错误**：只返回城市名，避免无关内容
5. ✅ **工资提取错误**：只返回薪资数字，避免无关内容
6. ✅ **邮箱截断**：返回最长邮箱，避免截断问题
7. ✅ **文件名信息利用**：从文件名提取信息作为补充

## 使用方法

直接运行程序：
```bash
python main.py
```

程序会：
1. 扫描 `datas` 文件夹中的所有PDF文件
2. 提取每个文件的信息
3. 导出为Excel文件（带时间戳）
4. 显示处理统计信息

## 依赖库

```bash
pip install pdfplumber PyPDF2 openpyxl
```

## 注意事项

- 提取准确率取决于PDF文件的质量和格式
- 对于扫描版PDF，建议先进行OCR处理
- 文件名格式需要符合规范才能被正确解析
- 系统遵循"宁缺毋滥"原则，提取不到的信息会留空
