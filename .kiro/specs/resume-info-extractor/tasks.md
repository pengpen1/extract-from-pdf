# 实施计划

- [x] 1. 创建项目结构和数据模型
  - 创建主程序文件 main.py 和模块目录结构
  - 定义 ResumeInfo 和 ProcessingResult 数据类
  - 定义自定义异常类 PDFExtractionError 和 ExcelExportError
  - _需求: 1.2, 6.4_

- [x] 2. 实现文件扫描模块
  - 编写 FileScanner 类，实现 __init__ 和 scan_pdf_files 方法
  - 实现递归扫描逻辑，使用 pathlib.Path.rglob('*.pdf') 查找所有PDF文件
  - 添加文件夹不存在时的自动创建逻辑
  - _需求: 1.1, 4.3_

- [x] 3. 实现PDF文本提取模块
  - 集成 pdfplumber 作为主要提取库，提取前3页内容
  - 实现 PyPDF2 作为备用提取方案
  - 添加异常处理，捕获文件读取错误和解析错误
  - _需求: 1.2, 6.4_

- [x] 4. 实现信息提取模块 - 电话和邮箱
  - 编写 InfoExtractor 类框架
  - 实现 extract_phone 方法，使用正则表达式 `1[3-9]\d{9}` 匹配手机号
  - 实现 extract_email 方法，使用正则表达式匹配邮箱地址
  - 处理未找到情况，返回 None 或默认值
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 5. 实现信息提取模块 - 姓名识别
  - 实现位置启发式策略，在前200字符中查找2-4个连续中文字符
  - 实现过滤规则，排除常见标题词和包含数字/特殊符号的文本
  - 实现多策略组合逻辑，优先使用关键词模式，回退到启发式方法
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [ ] 6. 实现Excel导出模块
  - 编写 ExcelExporter 类，实现 __init__ 和 export 方法
  - 使用 openpyxl 创建工作簿，添加表头（文件名、姓名、手机号、邮箱）
  - 实现数据行写入逻辑，遍历 ResumeInfo 列表填充数据
  - 实现时间戳文件名生成（格式：简历提取结果_YYYYMMDD_HHMMSS.xlsx）
  - 添加列宽自动调整功能
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [ ] 7. 实现主控制器和流程编排
  - 编写 ResumeExtractorApp 类，实现 __init__ 和 run 方法
  - 实现启动欢迎界面显示
  - 实现文件扫描调用和空文件夹检查
  - 实现文件处理循环，逐个调用 PDF提取 → 信息提取
  - 实现进度显示，格式：[当前/总数] 正在处理: 文件名 ... ✓/✗
  - 收集处理结果和错误信息
  - 调用Excel导出并显示输出路径
  - _需求: 1.3, 1.4, 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 8. 实现错误处理和统计
  - 在主控制器中添加 try-except 块，捕获单文件处理错误
  - 实现错误记录逻辑，收集失败文件名和错误原因
  - 实现处理完成后的统计信息显示（总数、成功数、失败数、失败文件列表）
  - 添加等待用户按键退出的逻辑（input("按任意键退出...")）
  - _需求: 6.3, 6.4, 6.5_

- [ ] 9. 创建程序入口点
  - 在 main.py 中添加 if __name__ == "__main__": 入口
  - 实例化 ResumeExtractorApp 并调用 run 方法
  - 添加顶层异常处理，捕获致命错误并显示友好错误信息
  - _需求: 4.1, 4.4_

- [ ] 10. 配置PyInstaller打包
  - 创建 requirements.txt 文件，列出所有依赖（pdfplumber, PyPDF2, openpyxl）
  - 编写 build.spec 配置文件或使用命令行参数
  - 配置打包选项：--onefile（单文件）、--console（显示控制台）、--name（程序名称）
  - 测试打包命令：pyinstaller --onefile --name="简历信息提取工具" --console main.py
  - _需求: 4.1, 4.2, 4.5_

- [ ]* 11. 创建使用说明文档
  - 编写 README.txt 文件，包含使用步骤和系统要求
  - 说明 datas 文件夹的用途和使用方法
  - 说明输出Excel文件的位置和命名规则
  - 添加常见问题解答（如PDF无法读取、加密PDF等）
  - _需求: 6.1_

- [ ]* 12. 端到端测试和优化
  - 准备10-20份不同格式的测试简历（包含各种边界情况）
  - 运行完整流程，验证所有功能正常工作
  - 测试打包后的exe文件在干净的Windows环境中运行
  - 验证Excel输出格式和数据准确性
  - 根据测试结果调整信息提取规则和错误处理逻辑
  - _需求: 1.3, 2.5, 3.4, 5.5_
